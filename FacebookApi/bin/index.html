<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
	<title>FacebookApi</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="language" content="en" />
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	
	<script src="js/swfobject.js" type="text/javascript"></script>
	<script type="text/javascript">
		var flashvars = {
		};
		var params = {
			menu: "false",
			scale: "noScale",
			allowFullscreen: "true",
			allowScriptAccess: "always",
			bgcolor: "#FFFFFF"
		};
		var attributes = {
			id:"FacebookApi"
		};
		swfobject.embedSWF("FacebookApi.swf", "altContent", "100%", "100%", "9.0.0", "expressInstall.swf", flashvars, params, attributes);
	</script>
	
	<style>
		html, body { height:100%; }
		body { margin:0; }
	</style>
</head>
<body>
	<div id="altContent">
		<h1>FacebookApi</h1>
		<p>Alternative content</p>
		<p><a href="http://www.adobe.com/go/getflashplayer"><img 
			src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" 
			alt="Get Adobe Flash player" /></a></p>
	</div>
	<script src="http://static.ak.connect.facebook.com/js/api_lib/v0.4/FeatureLoader.js.php" type="text/javascript"> </script>  
		<div id="flashContent"> </div>  
		<script type="text/javascript">  
		
		//當Flash被載入後flash會呼叫這個function進行FB.init的初始化  
		function initFB() {  
			FB.init(api_key, "xd_receiver.htm", {"ifUserConnected":onConnected,"ifUserNotConnected":onNotConnected});  
		}  
		  
		//判斷當User登入後，取得secret及session_key並傳給Flash。  
		//由於WebSession好像無法直接取得登入者的uid，  
		//因此這邊我順便將uid也傳入給flash  
		function onConnected() {  
			alert("onConnected");  
			var apiClient = new FB.ApiClient(api_key);  
			document.getElementById("${application}").fbConnected(apiClient.get_session().uid, apiClient.get_session().secret, apiClient.get_session().session_key);  
		}  
		  
		//如果沒登入，暫時不做任何事情  
		function onNotConnected() {
			alert("not connected");
		}
	</script>

</body>
</html>