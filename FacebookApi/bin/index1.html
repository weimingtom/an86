<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
	<title>FacebookApi</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="language" content="en" />
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<style>
		html, body { height:100%; }
		body { margin:0; }
	</style>
</head>
<body onload="javascript:initFB();">
	<!--<script type="text/javascript" src="js/swfobject.js"> </script> --> 
	<script src="http://static.ak.connect.facebook.com/js/api_lib/v0.4/FeatureLoader.js.php" type="text/javascript"></script>  
	<div id="flashContent"></div>  
	<script type="text/javascript">  
		//Application Key  
		var api_key = "d3ab1778daf9005779348cbccfaa8261";  
		
		//將Application Key藉由FlashVars傳給flash  
		//var flashVars = new Object();  
		//flashVars.api_key = api_key;  
		//swfobject.embedSWF("FacebookApi.swf", "flashContent", "800", "600", "9.0.47", "expressInstall.swf", flashVars, {}, {id:"FacebookApi",name:"FacebookApi"});  
		
		//當Flash被載入後flash會呼叫這個function進行FB.init的初始化  
		function initFB() {  
			FB.init(api_key, "xd_receiver.htm", {"ifUserConnected":onConnected,"ifUserNotConnected":onNotConnected});  
		}  
		  
		//判斷當User登入後，取得secret及session_key並傳給Flash。  
		//由於WebSession好像無法直接取得登入者的uid，  
		//因此這邊我順便將uid也傳入給flash  
		function onConnected(uid) {
			document.getElementById("loginBtn").style.display = "none";  
			//alert(uid);
			//var apiClient = new FB.ApiClient(api_key);  
			var fb = FB;
			var session = fb.Facebook.apiClient.get_session();
			alert(uid+" , "+session.session_key);
		}  
		function onNotConnected() {  
			alert("not connected");  
			document.getElementById("loginBtn").style.display = "block";  
		}
	</script>
	
	<div id="loginBtn" style="display:block">  
	<fb:login-button></fb:login-button>  
	</div>  
</body>
</html>